<script type="text/x-red" data-template-name="Script">
<div class="editor-form-row-margin-bottom-1">
        <label for="node-input-script"><span data-i18n="common.label.code-editor"></span></label>
        <input type="hidden" id="node-input-script" autofocus="autofocus">
    </div>
    <div class="editor-form-row node-text-editor-row" style="position:relative">
        <div style="height: inherit; min-height:150px;" class="node-text-editor" id="node-input-script-editor" ></div>
    </div>
</script>



<script type="text/javascript">
    registerNode({
        nodeType: 'Script',
        nodeDef: {
            color: "#FF4B2B",
            category: 'Function',
            defaults: {
                name: { value: "" },
                script: { value: "" },
            },
            inputs: 1,
            outputs: 1,
            icon: "ndefault-all-nodes/script-node.svg",
            label: function () {
                return this.name || "Script";
            },
            oneditprepare: function (SRD) {
                let node = this;
                this.editor = SRD.editor.createEditor({
                    id: 'node-input-script-editor',
                    language: 'typescript',
                    value: $("#node-input-script").val(),
                });
            },
            oneditsave: function () {
                $("#node-input-script").val(this.editor.getValue());
                this.editor.dispose();
                this.editor = null;
            },
            oneditcancel: function () {
                this.editor.dispose();
                this.editor = null;
            },
            oneditresize: function () {
                this.editor.layout();
            },
            docsLink: 'script-node'
        }
    });
</script>