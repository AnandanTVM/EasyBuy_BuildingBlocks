<script type="text/x-red" data-template-name="basicauth-config">
    <!-- name -->
    <div class="editor-form-row">
        <input type="text" id="node-input-name">
    </div>
    <div class="editor-form-row">
        <label><span>Username</span></label>
        <input type="text" id="node-input-typed-username"  style="width:100%">
    </div>
    <div class="editor-form-row">
        <label><span>Password</span></label>
        <input type="text" id="node-input-typed-password"  style="width:100%">
    </div>
   
</script>
<script type="text/javascript">

    registerNode({
        nodeType: 'basicauth-config',
        serviceType: 'server',
        nodeDef: {
            category: 'config',
            defaults: {
                name: {
                    value: '',
                    // attrDef: { attrType: 'INPUT', options: { placeholder: 'Name' } }
                },
                username: {
                    value: '',
                    required: true
                },
                password: {
                    value: '',
                    required: true
                }
            },
            label: function () {
                return this.name || "Basic Auth Config";
            },
            
            oneditinit: function (SRD) {
                let node = this;
                const doneBtn = $('#node-config-dialog-ok');
                const strTypes = [{ value: 'str', label: 'string', validate: SRD.validators.patterns.noblank}];
                const envTypes = [{ value: 'process.env', label: 'env', validate: SRD.validators.patterns.noblank}];

                let nodeName = $(`#node-input-name`).inputField({
                    placeholder: SRD._('common.label.name')
                });
                $('#node-input-typed-username').typedInput({
                    types: [...strTypes, ...envTypes],
                    onvalchanged: () => {
                        validateForm();
                    }
                });
                $('#node-input-typed-password').typedInput({
                    types: [...strTypes, ...envTypes],
                    onvalchanged: () => {
                        validateForm();
                    }
                });
                function validateForm () {
                    if (([...$('.red-ui-typedInput-input.input-error')].some(e => !$(e).is(':hidden')))) {
                        doneBtn.addClass('disabled');
                    } else {
                        doneBtn.removeClass('disabled');
                    }
                }
                validateForm ();
            },
            oneditsave: function (SRD, changes) {
               console.log(this)
            }
        }
    });
</script>