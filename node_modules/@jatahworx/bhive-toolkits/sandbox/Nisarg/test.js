let ServiceGenerator = require("./ServiceGenerator");
let Variable = require("../../ServiceDesigner/nodes/Variable")
let Start = require("../../ServiceDesigner/nodes/Start/Start");
let Script = require("../../ServiceDesigner/nodes/Script/Script");
let Switch = require("../../ServiceDesigner/nodes/Switch/Switch");
let Condition = require("../../ServiceDesigner/nodes/Switch/Condition");
let End = require("../../ServiceDesigner/nodes/End/End")

let sg = new ServiceGenerator();

let end = new End("end");

let adsf = [{ 'name': 'Nisarg', 'surname': 'Tuli' }];
console.log({} instanceof Object);
console.log()


sg.createServiceClass("CalculatorService").then((serviceClassTemplate) => {
    console.log("service file created...")
    let ivar1 = new Variable("number1", 50, true);
    let ivar2 = new Variable("number2", 5, false);
    // let ivar3 = new Variable("surname", "Tuli", false);
    // let ivar4 = new Variable("undefined", undefined, false)
    // let ivar5 = new Variable("number", 100, true)
    // let ivar6 = new Variable("boolean", false, false)
    // let ivar7 = new Variable("array", ['Nisarg','Tuli'], false)
    // let ivar8 = new Variable("objectarray", [{"string":"asdfasdf", "number":1234, "boolean":false, 'null' : null, 'undefined':undefined, "array":["asdf",234,false,null], 'object' : {"asdf":"asdf"}}], false)
    // let ivar9 = new Variable("object", {'name':'Nisarg', 'surname':'Tuli'}, false)

    let lvar1 = new Variable("mul", null, true)
    let lvarSubstract = new Variable("sub", null, true)
    // let lvar2 = new Variable("string", "Nisarg", true)
    // let lvar3 = new Variable("undefined", undefined, false)
    // let lvar4 = new Variable("number", 100, false)
    // let lvar5 = new Variable("boolean", false, false)
    // let lvar6 = new Variable("array", ['Nisarg','Tuli'], true)
    // let lvar7 = new Variable("objectarray", [{"string":"asdfasdf", "number":1234, "boolean":false, 'null' : null, 'undefined':undefined, "array":["asdf",234,false,null], 'object' : {"asdf":"asdf"}}], false)
    // let lvar8 = new Variable("object", {'name':'Nisarg', 'surname':'Tuli'}, false)

    // let inputVariables = [ivar1, ivar2, ivar3, ivar4, ivar5, ivar6,ivar7, ivar8, ivar9];
    // let localVariabbles = [lvar1, lvar2, lvar3, lvar4, lvar5, lvar6, lvar7, lvar8,lvarSubstract];

    let inputVariables = [ivar1, ivar2];
    let localVariabbles = [lvar1, lvarSubstract];

    let startMul = new Start("Multiply", "multiply", inputVariables, localVariabbles, "CalculatorService");
    let startSub = new Start("Subtract", "subtraction", inputVariables, localVariabbles, "CalculatorService");

    let scriptMultiply = new Script("scriptMultiply", "bh.local.mul = bh.input.number1 * bh.input.number2;");
    let scriptSubtract = new Script("scriptSubtract", "bh.local.sub = bh.input.number1 - bh.input.number2;");

    // let script3 = new Script("log number 2", "console.log(number2);");
    let condition2 = new Condition("genderMale", [scriptSubtract], "neq", "'female'");
    let switchNodeCond2 = new Switch("checkGender", "bh.local.gender", [condition2]);

    let condition = new Condition("agele10", [scriptMultiply, switchNodeCond2 ], "eq", 10);
    let condition1 = new Condition("agele101", [scriptSubtract, scriptMultiply], "eq", "bh.input.number2");


    let condArr = [condition, condition1, condition2];
    let switchNode = new Switch("checkAge", "bh.local.age", condArr);

    


    let flowMul = [startMul,scriptMultiply, switchNode, end];
    let flowSub = [startSub, scriptSubtract, end];

    let Allflows = [flowMul];

    console.log(JSON.stringify(Allflows));
    sg.insertAllFlows(Allflows, serviceClassTemplate, "CalculatorService").then(() => {
        console.log("flow inserted...")
    }).catch(e => {
        console.error(e);
    });
}).catch(e => {
    console.error(e)
});

console.log(Buffer)
// await